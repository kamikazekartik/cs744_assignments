INFO:root:using Tesla V100-SXM2-16GB
INFO:root:weight    : BlockFloatingPoint (wl=8, dim=0)
INFO:root:activate  : BlockFloatingPoint (wl=8, dim=0)
INFO:root:grad      : BlockFloatingPoint (wl=8, dim=0)
INFO:root:error     : BlockFloatingPoint (wl=8, dim=0)
INFO:root:momentum  : BlockFloatingPoint (wl=8, dim=0)
INFO:root:Running experiment with args: Namespace(batch_size=64, dataset='Cifar10', device='cuda', gamma=0.998, low_prec=False, lr=0.01, max_epochs=6, model='preresnet', nbits_activate=8, nbits_error=8, nbits_grad=8, nbits_momentum=8, nbits_weight=8, num_classes=1000, preload_data=False, pruned_model_path=None, results_filename='output/v100_fullmodel/results_preresnet_Cifar10_batchsize64_AMP', rounding='stochastic', save_model=False, seed=42, test_batch_size=1000, use_amp=True, use_half=False)
Seeded everything with seed: 42
Files already downloaded and verified
Files already downloaded and verified
Building unpruned resnet from scratch
INFO:root:Accuracy of plane :  0 %
INFO:root:Accuracy of   car :  0 %
INFO:root:Accuracy of  bird :  0 %
INFO:root:Accuracy of   cat :  0 %
INFO:root:Accuracy of  deer :  0 %
INFO:root:Accuracy of   dog :  9 %
INFO:root:Accuracy of  frog : 87 %
INFO:root:Accuracy of horse :  1 %
INFO:root:Accuracy of  ship :  6 %
INFO:root:Accuracy of truck :  0 %
INFO:root:
Test set: Average loss: 0.0002, Accuracy: 1042/10000 (10%)

INFO:root:Train Epoch: 1 [0 (0%)]	Loss: 2.297179
INFO:root:Train Epoch: 1 [32000 (64%)]	Loss: 1.952363
INFO:root:Train Epoch: 2 [0 (0%)]	Loss: 1.990804
INFO:root:Train Epoch: 2 [32000 (64%)]	Loss: 1.758832
INFO:root:Train Epoch: 3 [0 (0%)]	Loss: 2.006666
INFO:root:Train Epoch: 3 [32000 (64%)]	Loss: 1.618099
INFO:root:Train Epoch: 4 [0 (0%)]	Loss: 1.626512
INFO:root:Train Epoch: 4 [32000 (64%)]	Loss: 1.497977
INFO:root:Train Epoch: 5 [0 (0%)]	Loss: 1.356564
INFO:root:Train Epoch: 5 [32000 (64%)]	Loss: 1.156235
INFO:root:Results: 
INFO:root:   epoch  training_loss  test_acc  epoch_train_time  total_train_time    lr
0      0      -1.000000     10.42         -1.000000         -1.000000 -1.00
1      1       1.666925     -1.00         70.071377         70.071377  0.01
2      2       1.442990     -1.00         69.547979        139.619355  0.01
3      3       1.765742     -1.00         72.110409        211.729765  0.01
4      4       1.344530     -1.00         70.402315        282.132080  0.01
5      5       1.503986     -1.00         73.311935        355.444015  0.01
